import{u as g,j as e,c as j,a as v}from"./index-CtFufLgh.js";import{r as i}from"./vendor-D8AvkUoV.js";import{u as N,a as w,o as S,s as l,_ as k,l as n}from"./schemas-BznUp_a-.js";import{e as d,b as F,z as P,D as E,w as B,E as C,G as L,g as u}from"./ui-CX4g-7i5.js";const z=S({name:l().min(2,"Name must be at least 2 characters"),phone:l().optional().or(n("")),institution:l().optional().or(n("")),category:k(["student","professional","educator","hobbyist"]),bio:l().max(500,"Bio must be less than 500 characters").optional().or(n(""))});function V(){const{user:s,refreshProfile:p}=g(),[m,c]=i.useState(!1),[x,h]=i.useState(!0),{register:a,handleSubmit:b,setValue:t,formState:{errors:r}}=N({resolver:w(z),defaultValues:{category:"student"}});i.useEffect(()=>{s&&(t("name",s.name),t("phone",s.phone||""),t("institution",s.institution||""),t("category",s.category||"student"),t("bio",s.bio||""),h(!1))},[s,t]);const f=async o=>{if(s){c(!0);try{await v.post("/profile/update.php",{name:o.name,phone:o.phone||null,institution:o.institution||null,category:o.category,bio:o.bio||null}),await p(),u.success("Profile updated successfully")}catch(y){console.error("Error updating profile:",y),u.error("Failed to update profile")}finally{c(!1)}}};return x?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(d,{className:"w-8 h-8 animate-spin text-primary-600"})}):e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Profile Settings"}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"p-6 sm:p-8",children:e.jsxs("form",{onSubmit:b(f),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(F,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{...a("name"),type:"text",className:j("block w-full pl-10 pr-3 py-2 border rounded-lg shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",r.name?"border-red-300":"border-gray-300"),placeholder:"Your full name"})]}),r.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(P,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{...a("phone"),type:"tel",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"+91 9876543210"})]}),r.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.phone.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"institution",className:"block text-sm font-medium text-gray-700 mb-1",children:"Institution / Organization"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(E,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{...a("institution"),type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"University or Company name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(B,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("select",{...a("category"),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"educator",children:"Educator"}),e.jsx("option",{value:"hobbyist",children:"Hobbyist"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-3 left-3 pointer-events-none",children:e.jsx(C,{className:"h-5 w-5 text-gray-400"})}),e.jsx("textarea",{...a("bio"),rows:4,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Tell us a bit about yourself..."})]}),r.bio&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.bio.message})]}),e.jsx("div",{className:"pt-4 border-t border-gray-100 flex justify-end",children:e.jsx("button",{type:"submit",disabled:m,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:m?e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"w-5 h-5 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-5 h-5 mr-2"}),"Save Changes"]})})})]})})})]})}export{V as Profile};
