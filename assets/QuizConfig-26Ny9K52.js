import{j as e,c as n,b as U}from"./index-CH9rPkG_.js";import{r as g,u as J}from"./vendor-D8AvkUoV.js";import{u as K,a as V,o as H,c as B,s as D,_ as F}from"./schemas-BznUp_a-.js";import{u as Y}from"./quizStore-DOj72SYB.js";import{Z,x as X,U as G,I as $,y as W,k as O,z as ee,s as se,B as te,C as ae,w as re,E as P,G as ie,J as ne,K as le,m as oe,N as ce}from"./ui-CEq2p6SN.js";function de(){const{currentAttempt:p,questions:c,responses:w,currentQuestionIndex:r,timeRemaining:v,isLoading:l,generateQuiz:o,startAttempt:Q,submitAnswer:T,nextQuestion:S,previousQuestion:b,submitQuiz:k,resetQuiz:C,setTimeRemaining:_}=Y(),u=c[r],E=u?w.get(u.id):void 0,q={current:r+1,total:c.length,percentage:c.length>0?(r+1)/c.length*100:0},a=r===0,d=r===c.length-1,h=c.every(x=>w.has(x.id));return{currentAttempt:p,questions:c,currentQuestion:u,currentResponse:E,timeRemaining:v,isLoading:l,progress:q,isFirstQuestion:a,isLastQuestion:d,allAnswered:h,generateQuiz:async x=>{await o(x)},startAttempt:Q,submitAnswer:(x,I)=>{u&&T(u.id,x,I)},nextQuestion:S,previousQuestion:b,submitQuiz:k,resetQuiz:C,setTimeRemaining:_}}const me=H({numQuestions:F(["3","5","10","20","50"]),difficulty:F(["Easy","Medium","Hard","Mixed"]),categories:B(D()),types:B(D()).optional()}),y=[{id:"text_mcq",label:"Multiple Choice",icon:X},{id:"image_identify_person",label:"Identify Person",icon:G},{id:"image_identify_logo",label:"Identify Logo",icon:$},{id:"true_false",label:"True / False",icon:W}],N={"Latest Developments":{icon:e.jsx(ce,{className:"w-5 h-5"}),gradient:"from-blue-500 to-cyan-500"},"AI Safety":{icon:e.jsx(oe,{className:"w-5 h-5"}),gradient:"from-emerald-500 to-teal-500"},Robotics:{icon:e.jsx(le,{className:"w-5 h-5"}),gradient:"from-orange-500 to-amber-500"},"Quantum Computing":{icon:e.jsx(ne,{className:"w-5 h-5"}),gradient:"from-violet-500 to-purple-500"},"Generative AI":{icon:e.jsx(ie,{className:"w-5 h-5"}),gradient:"from-pink-500 to-rose-500"},Personalities:{icon:e.jsx(G,{className:"w-5 h-5"}),gradient:"from-indigo-500 to-blue-500"},Brands:{icon:e.jsx(P,{className:"w-5 h-5"}),gradient:"from-yellow-500 to-orange-500"}};function ge(){const{register:p,handleSubmit:c,watch:w,formState:{errors:r,isValid:v},setValue:l}=K({resolver:V(me),mode:"onChange",defaultValues:{numQuestions:"5",difficulty:"Mixed",categories:[],types:[]}}),[o,Q]=g.useState([]),[T,S]=g.useState(!1),[b,k]=g.useState(!1),[C,_]=g.useState(null),u=J(),{generateQuiz:E}=de();g.useEffect(()=>{(async()=>{S(!0);try{const i=(await U.get("/questions/stats.php")).data.stats,m=Object.entries(i).map(([f,A])=>{const j=N[f]||{icon:e.jsx(P,{className:"w-5 h-5"}),gradient:"from-slate-500 to-gray-500"};return{name:f,available:Number(A),icon:j.icon,gradient:j.gradient}});m.sort((f,A)=>{const j=!!N[f.name],M=!!N[A.name];return j&&!M?-1:!j&&M?1:f.name.localeCompare(A.name)}),Q(m)}catch(t){console.error("Failed to fetch category counts",t);const i=Object.keys(N).map(m=>({name:m,available:0,...N[m]}));Q(i)}finally{S(!1)}})()},[]),g.useEffect(()=>{const s=localStorage.getItem("quizConfig");if(s)try{const t=JSON.parse(s);l("numQuestions",t.numQuestions);const i=t.difficulty||"Mixed",m=i.charAt(0).toUpperCase()+i.slice(1).toLowerCase();l("difficulty",m),l("categories",t.categories),t.types&&l("types",t.types)}catch{}},[l]);const q=async s=>{_(null),k(!0),localStorage.setItem("quizConfig",JSON.stringify(s));try{const t={numQuestions:Number(s.numQuestions),difficulty:s.difficulty.toLowerCase(),categories:s.categories,types:s.types,timeLimit:Number(s.numQuestions)*30,includeExplanations:!0};await E(t),u("/take-quiz")}catch(t){const i=t.response?.data?.error||t.message||"Failed to generate quiz";_(i)}finally{k(!1)}},a=w(),d=a.categories,h=a.types||[],L=d.length>0?d.reduce((s,t)=>{const i=o.find(m=>m.name===t);return s+(i?.available||0)},0):o.reduce((s,t)=>s+t.available,0),z=L<Number(a.numQuestions),x=Number(a.numQuestions)*30,I=()=>{d.length===o.length?l("categories",[]):l("categories",o.map(s=>s.name))},R=()=>{h.length===y.length?l("types",[]):l("types",y.map(s=>s.id))};return e.jsxs("div",{className:"max-w-5xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white tracking-tight",children:"Configure Quiz"}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Customize your assessment parameters"})]}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"p-3 bg-primary/10 rounded-xl border border-primary/20",children:e.jsx(Z,{className:"w-6 h-6 text-primary"})})})]}),e.jsx("form",{onSubmit:c(q),className:"space-y-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("section",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center mr-3 text-sm font-bold",children:"1"}),"Number of Questions"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:["3","5","10","20","50"].map(s=>e.jsxs("label",{className:n("relative flex flex-col items-center justify-center p-4 rounded-2xl cursor-pointer transition-all duration-200 border-2",a.numQuestions===s?"bg-primary/10 border-primary shadow-[0_0_20px_-5px_rgba(0,212,255,0.5)]":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"),children:[e.jsx("input",{type:"radio",value:s,...p("numQuestions"),className:"hidden"}),e.jsx("span",{className:n("text-2xl font-bold mb-1",a.numQuestions===s?"text-primary":"text-white"),children:s}),e.jsx("span",{className:"text-xs text-slate-400 uppercase tracking-wider font-medium",children:"Questions"})]},s))}),r.numQuestions&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:r.numQuestions.message})]}),e.jsxs("section",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-purple-500/20 text-purple-400 flex items-center justify-center mr-3 text-sm font-bold",children:"2"}),"Difficulty Level"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:["Easy","Medium","Hard","Mixed"].map(s=>e.jsxs("label",{className:n("relative flex items-center justify-center p-4 rounded-2xl cursor-pointer transition-all duration-200 border-2",a.difficulty===s?"bg-cyan-500/10 border-cyan-500 shadow-[0_0_20px_-5px_rgba(6,182,212,0.5)]":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"),children:[e.jsx("input",{type:"radio",value:s,...p("difficulty"),className:"hidden"}),e.jsx("span",{className:n("font-bold",a.difficulty===s?"text-cyan-400":"text-slate-300"),children:s})]},s))}),r.difficulty&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:r.difficulty.message})]}),e.jsxs("section",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-pink-500/20 text-pink-400 flex items-center justify-center mr-3 text-sm font-bold",children:"3"}),"Question Types"]}),e.jsx("button",{type:"button",onClick:R,className:"text-sm text-primary hover:text-primary/80 font-medium transition-colors",children:h.length===y.length?"Deselect All":"Select All"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:y.map(s=>{const t=h.includes(s.id);return e.jsxs("label",{className:n("relative flex flex-col items-center justify-center p-4 rounded-2xl cursor-pointer transition-all duration-200 border-2 text-center",t?"bg-pink-500/10 border-pink-500 shadow-[0_0_20px_-5px_rgba(236,72,153,0.5)]":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"),children:[e.jsx("input",{type:"checkbox",value:s.id,...p("types"),className:"hidden"}),e.jsx("div",{className:n("mb-2 p-2 rounded-lg",t?"bg-pink-500/20 text-pink-400":"bg-white/10 text-slate-400"),children:e.jsx(s.icon,{className:"w-6 h-6"})}),e.jsx("span",{className:n("font-bold text-sm",t?"text-pink-400":"text-slate-300"),children:s.label})]},s.id)})}),e.jsx("p",{className:"text-xs text-slate-500 mt-4 text-center",children:"Select specific question types or leave blank to include all."})]}),e.jsxs("section",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-emerald-500/20 text-emerald-400 flex items-center justify-center mr-3 text-sm font-bold",children:"4"}),"Topics"]}),e.jsx("button",{type:"button",onClick:I,className:"text-sm text-primary hover:text-primary/80 font-medium transition-colors",children:d.length===o.length&&o.length>0?"Deselect All":"Select All"})]}),T?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(O,{className:"w-8 h-8 animate-spin text-emerald-500"})}):o.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No topics available."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(s=>{const t=d.includes(s.name);return e.jsxs("label",{className:n("group relative flex items-center p-4 rounded-2xl cursor-pointer transition-all duration-200 border-2 overflow-hidden",t?"bg-emerald-500/10 border-emerald-500 shadow-[0_0_20px_-5px_rgba(16,185,129,0.3)]":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"),children:[e.jsx("div",{className:n("absolute inset-0 opacity-0 transition-opacity duration-300",t?"opacity-100":"group-hover:opacity-10"),children:e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${s.gradient} opacity-5`})}),e.jsx("input",{type:"checkbox",value:s.name,...p("categories"),className:"hidden"}),e.jsx("div",{className:n("p-3 rounded-xl mr-4 transition-colors",t?"bg-emerald-500/20 text-emerald-400":"bg-white/5 text-slate-400 group-hover:text-white"),children:s.icon}),e.jsxs("div",{className:"flex-1 relative z-10",children:[e.jsx("p",{className:n("font-bold transition-colors",t?"text-white":"text-slate-300 group-hover:text-white"),children:s.name}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[s.available," questions"]})]}),t&&e.jsx(ee,{className:"w-6 h-6 text-emerald-500 animate-in zoom-in duration-200"})]},s.name)})}),e.jsx("p",{className:"text-xs text-slate-500 mt-4 text-center",children:"Select specific topics or leave blank to include all."}),r.categories&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:r.categories.message})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"sticky top-8 space-y-6",children:e.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Summary"}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-slate-400",children:"Questions"}),e.jsx("span",{className:"font-bold text-white",children:a.numQuestions})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-slate-400",children:"Difficulty"}),e.jsx("span",{className:"font-bold text-white",children:a.difficulty})]}),e.jsxs("div",{className:"py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-slate-400 block mb-2",children:"Types"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:h.length>0?h.map(s=>{const t=y.find(i=>i.id===s);return e.jsx("span",{className:"px-2 py-1 rounded-lg bg-white/5 text-xs text-slate-300 border border-white/5",children:t?.label||s},s)}):e.jsx("span",{className:"text-slate-600 text-sm italic",children:"All Types"})})]}),e.jsxs("div",{className:"py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-slate-400 block mb-2",children:"Topics"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.length>0?d.map(s=>e.jsx("span",{className:"px-2 py-1 rounded-lg bg-white/5 text-xs text-slate-300 border border-white/5",children:s},s)):e.jsx("span",{className:"text-slate-600 text-sm italic",children:"Any Topic"})})]}),e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsxs("span",{className:"text-slate-400 flex items-center",children:[e.jsx(se,{className:"w-4 h-4 mr-2"})," Est. Time"]}),e.jsxs("span",{className:"font-bold text-primary",children:[Math.round(x/60)," min ",x%60,"s"]})]})]}),z&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-red-500/10 border border-red-500/20 flex items-start",children:[e.jsx(te,{className:"w-5 h-5 text-red-400 mr-3 shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm text-red-400",children:["Selected topics have ",L," questions, but you requested ",a.numQuestions,"."]})]}),e.jsxs("button",{type:"submit",disabled:!v||z||b,className:n("w-full flex items-center justify-center px-8 py-4 text-base font-bold rounded-xl shadow-lg transition-all duration-300 transform hover:-translate-y-1",!v||z||b?"bg-slate-800 text-slate-500 cursor-not-allowed":"btn-vibeai"),children:[b?e.jsx(O,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(ae,{className:"w-5 h-5 mr-2"}),b?"Generating...":"Start Quiz"]}),C&&e.jsxs("p",{className:"mt-4 text-sm text-red-400 flex items-center justify-center",children:[e.jsx(re,{className:"w-4 h-4 mr-2"})," ",C]})]})})})]})})]})}export{ge as QuizConfig};
