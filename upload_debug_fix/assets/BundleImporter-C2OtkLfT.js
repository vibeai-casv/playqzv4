import{j as e,a as j,d as y}from"./index-Dylif5oX.js";import{r as d}from"./vendor-D8AvkUoV.js";import{ad as c,v as m,n as p,x as N,h as l}from"./ui-BDjwW725.js";function I({onImportComplete:x,onCancel:u}){const[t,g]=d.useState(null),[n,o]=d.useState(!1),[a,i]=d.useState(null),h=s=>{const r=s.target.files?.[0];if(r){if(!r.name.endsWith(".zip")){l.error("Please select a ZIP file");return}g(r),i(null)}},b=async()=>{if(!t){l.error("Please select a file");return}o(!0),i(null);try{const s=new FormData;s.append("bundle",t);const r=await j.post("/bundle/import.php",s,{headers:{"Content-Type":"multipart/form-data"}});i(r.data.stats),r.data.stats.questions_imported>0?l.success("Successfully imported bundle!"):l.warning("No new questions were imported (records may already exist)")}catch(s){console.error("Import error:",s);let r="Failed to import bundle";y.isAxiosError(s)&&s.response?.data?.error?r=s.response.data.error:s instanceof Error&&(r=s.message),l.error(r)}finally{o(!1)}},f=()=>{a&&a.questions_imported>0?x():u()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center",children:[e.jsx(c,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"text-indigo-600 hover:text-indigo-700 font-medium",children:"Choose Question Bundle (ZIP)"}),e.jsx("input",{type:"file",accept:".zip",onChange:h,className:"hidden"})]}),t&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["Selected: ",t.name]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 text-sm text-blue-900 dark:text-blue-100",children:[e.jsxs("p",{className:"flex items-center gap-2 mb-1",children:[e.jsx(m,{className:"w-4 h-4"}),e.jsx("strong",{children:"Importing Bundles"})]}),e.jsx("p",{className:"opacity-90 ml-6",children:"Bundles contain questions and their associated images. Existing questions (by ID) will be skipped to prevent duplicates."})]})]}),a&&e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[e.jsx(p,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-medium",children:["Questions Imported: ",a.questions_imported]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400",children:[e.jsx(p,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-medium",children:["Images Imported: ",a.media_imported]})]}),a.questions_skipped>0&&e.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 dark:text-yellow-400",children:[e.jsx(m,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-medium",children:["Skipped (Duplicates): ",a.questions_skipped]})]}),a.errors.length>0&&e.jsxs("div",{className:"flex items-start gap-2 text-red-600 dark:text-red-400 pt-2 border-t border-gray-200 dark:border-gray-600 mt-2",children:[e.jsx(N,{className:"w-5 h-5 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"font-medium block mb-1",children:["Errors: ",a.errors.length]}),e.jsx("div",{className:"text-sm space-y-1 max-h-40 overflow-y-auto",children:a.errors.map((s,r)=>e.jsxs("div",{className:"text-xs",children:["â€¢ ",s]},r))})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:f,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:a?"Close":"Cancel"}),e.jsxs("button",{onClick:b,disabled:!t||n,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(c,{className:"w-4 h-4"}),n?"Importing...":"Import Bundle"]})]})]})}export{I as B};
