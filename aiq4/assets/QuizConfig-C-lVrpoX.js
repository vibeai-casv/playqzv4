import{j as e,c as r,b as J}from"./index-DROaUFFW.js";import{r as j,u as K}from"./vendor-D8AvkUoV.js";import{u as V,a as H,o as Y,c as D,s as F,_ as O}from"./schemas-BznUp_a-.js";import{u as Z}from"./quizStore-DzprzRkX.js";import{k as M,C as G,Z as X,x as $,U as P,I as W,y as ee,s as se,z as te,w as ae,B as re,E as R,G as ie,J as ne,K as le,m as oe,N as ce}from"./ui-BHrEg2Uj.js";function de(){const{currentAttempt:b,questions:o,responses:Q,currentQuestionIndex:i,timeRemaining:g,isLoading:l,generateQuiz:c,startAttempt:S,submitAnswer:E,nextQuestion:k,previousQuestion:d,submitQuiz:C,resetQuiz:_,setTimeRemaining:z}=Z(),h=o[i],q=h?Q.get(h.id):void 0,A={current:i+1,total:o.length,percentage:o.length>0?(i+1)/o.length*100:0},a=i===0,m=i===o.length-1,p=o.every(u=>Q.has(u.id));return{currentAttempt:b,questions:o,currentQuestion:h,currentResponse:q,timeRemaining:g,isLoading:l,progress:A,isFirstQuestion:a,isLastQuestion:m,allAnswered:p,generateQuiz:async u=>{await c(u)},startAttempt:S,submitAnswer:(u,I)=>{h&&E(h.id,u,I)},nextQuestion:k,previousQuestion:d,submitQuiz:C,resetQuiz:_,setTimeRemaining:z}}const me=Y({numQuestions:O(["3","5","10","20","50"]),difficulty:O(["Easy","Medium","Hard","Mixed"]),categories:D(F()),types:D(F()).optional()}),w=[{id:"text_mcq",label:"Multiple Choice",icon:$},{id:"image_identify_person",label:"Identify Person",icon:P},{id:"image_identify_logo",label:"Identify Logo",icon:W},{id:"true_false",label:"True / False",icon:ee}],v={"Latest Developments":{icon:e.jsx(ce,{className:"w-5 h-5"}),gradient:"from-blue-500 to-cyan-500"},"AI Safety":{icon:e.jsx(oe,{className:"w-5 h-5"}),gradient:"from-emerald-500 to-teal-500"},Robotics:{icon:e.jsx(le,{className:"w-5 h-5"}),gradient:"from-orange-500 to-amber-500"},"Quantum Computing":{icon:e.jsx(ne,{className:"w-5 h-5"}),gradient:"from-violet-500 to-purple-500"},"Generative AI":{icon:e.jsx(ie,{className:"w-5 h-5"}),gradient:"from-pink-500 to-rose-500"},Personalities:{icon:e.jsx(P,{className:"w-5 h-5"}),gradient:"from-indigo-500 to-blue-500"},Brands:{icon:e.jsx(R,{className:"w-5 h-5"}),gradient:"from-yellow-500 to-orange-500"}};function ge(){const{register:b,handleSubmit:o,watch:Q,formState:{errors:i,isValid:g},setValue:l}=V({resolver:H(me),mode:"onChange",defaultValues:{numQuestions:"5",difficulty:"Mixed",categories:[],types:[]}}),[c,S]=j.useState([]),[E,k]=j.useState(!1),[d,C]=j.useState(!1),[_,z]=j.useState(null),h=K(),{generateQuiz:q}=de();j.useEffect(()=>{(async()=>{k(!0);try{const n=(await J.get("/questions/stats.php")).data.stats,x=Object.entries(n).map(([y,T])=>{const N=v[y]||{icon:e.jsx(R,{className:"w-5 h-5"}),gradient:"from-slate-500 to-gray-500"};return{name:y,available:Number(T),icon:N.icon,gradient:N.gradient}});x.sort((y,T)=>{const N=!!v[y.name],B=!!v[T.name];return N&&!B?-1:!N&&B?1:y.name.localeCompare(T.name)}),S(x)}catch(t){console.error("Failed to fetch category counts",t);const n=Object.keys(v).map(x=>({name:x,available:0,...v[x]}));S(n)}finally{k(!1)}})()},[]),j.useEffect(()=>{const s=localStorage.getItem("quizConfig");if(s)try{const t=JSON.parse(s);l("numQuestions",t.numQuestions);const n=t.difficulty||"Mixed",x=n.charAt(0).toUpperCase()+n.slice(1).toLowerCase();l("difficulty",x),l("categories",t.categories),t.types&&l("types",t.types)}catch{}},[l]);const A=async s=>{z(null),C(!0),localStorage.setItem("quizConfig",JSON.stringify(s));try{const t={numQuestions:Number(s.numQuestions),difficulty:s.difficulty.toLowerCase(),categories:s.categories,types:s.types,timeLimit:Number(s.numQuestions)*30,includeExplanations:!0};await q(t),h("/take-quiz")}catch(t){const n=t.response?.data?.error||t.message||"Failed to generate quiz";z(n)}finally{C(!1)}},a=Q(),m=a.categories,p=a.types||[],L=m.length>0?m.reduce((s,t)=>{const n=c.find(x=>x.name===t);return s+(n?.available||0)},0):c.reduce((s,t)=>s+t.available,0),f=L<Number(a.numQuestions),u=Number(a.numQuestions)*30,I=()=>{m.length===c.length?l("categories",[]):l("categories",c.map(s=>s.name))},U=()=>{p.length===w.length?l("types",[]):l("types",w.map(s=>s.id))};return e.jsxs("div",{className:"max-w-5xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white tracking-tight",children:"Configure Quiz"}),e.jsx("p",{className:"text-slate-400 mt-1 md:mt-2 text-sm md:text-base",children:"Customize your assessment parameters"})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs("button",{type:"button",disabled:!g||f||d,onClick:o(A),className:r("flex-1 sm:flex-none flex items-center justify-center px-6 py-3 text-sm font-bold rounded-xl shadow-lg transition-all duration-300 transform hover:-translate-y-0.5",!g||f||d?"bg-slate-800 text-slate-500 cursor-not-allowed":"btn-vibeai"),children:[d?e.jsx(M,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(G,{className:"w-4 h-4 mr-2"}),"Start Quiz"]}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"p-2.5 bg-primary/10 rounded-xl border border-primary/20",children:e.jsx(X,{className:"w-5 h-5 text-primary"})})})]})]}),e.jsx("form",{onSubmit:o(A),className:"space-y-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"lg:w-1/3 lg:order-2",children:e.jsx("div",{className:"sticky top-24 space-y-6",children:e.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Summary"}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-slate-400",children:"Questions"}),e.jsx("span",{className:"font-bold text-white",children:a.numQuestions})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-slate-400",children:"Difficulty"}),e.jsx("span",{className:"font-bold text-white",children:a.difficulty})]}),e.jsxs("div",{className:"py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-slate-400 block mb-2",children:"Types"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:p.length>0?p.map(s=>{const t=w.find(n=>n.id===s);return e.jsx("span",{className:"px-2 py-1 rounded-lg bg-white/5 text-xs text-slate-300 border border-white/5",children:t?.label||s},s)}):e.jsx("span",{className:"text-slate-600 text-sm italic",children:"All Types"})})]}),e.jsxs("div",{className:"py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-slate-400 block mb-2",children:"Topics"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.length>0?m.map(s=>e.jsx("span",{className:"px-2 py-1 rounded-lg bg-white/5 text-xs text-slate-300 border border-white/5",children:s},s)):e.jsx("span",{className:"text-slate-600 text-sm italic",children:"Any Topic"})})]}),e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsxs("span",{className:"text-slate-400 flex items-center",children:[e.jsx(se,{className:"w-4 h-4 mr-2"})," Est. Time"]}),e.jsxs("span",{className:"font-bold text-primary",children:[Math.round(u/60)," min ",u%60,"s"]})]})]}),f&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-red-500/10 border border-red-500/20 flex items-start",children:[e.jsx(te,{className:"w-5 h-5 text-red-400 mr-3 shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm text-red-400",children:["Selected topics have ",L," questions, but you requested ",a.numQuestions,"."]})]}),e.jsxs("button",{type:"submit",disabled:!g||f||d,className:r("w-full flex items-center justify-center px-8 py-4 text-base font-bold rounded-xl shadow-lg transition-all duration-300 transform hover:-translate-y-1",!g||f||d?"bg-slate-800 text-slate-500 cursor-not-allowed":"btn-vibeai"),children:[d?e.jsx(M,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(G,{className:"w-5 h-5 mr-2"}),d?"Generating...":"Start Quiz"]}),_&&e.jsxs("p",{className:"mt-4 text-sm text-red-400 flex items-center justify-center",children:[e.jsx(ae,{className:"w-4 h-4 mr-2"})," ",_]})]})})}),e.jsxs("div",{className:"lg:w-2/3 space-y-8 lg:order-1",children:[e.jsxs("section",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center mr-3 text-sm font-bold",children:"1"}),"Number of Questions"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:["3","5","10","20","50"].map(s=>e.jsxs("label",{className:r("relative flex flex-col items-center justify-center p-4 rounded-2xl cursor-pointer transition-all duration-200 border-2",a.numQuestions===s?"bg-primary/10 border-primary shadow-[0_0_20px_-5px_rgba(0,212,255,0.5)]":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"),children:[e.jsx("input",{type:"radio",value:s,...b("numQuestions"),className:"hidden"}),e.jsx("span",{className:r("text-2xl font-bold mb-1",a.numQuestions===s?"text-primary":"text-white"),children:s}),e.jsx("span",{className:"text-xs text-slate-400 uppercase tracking-wider font-medium",children:"Questions"})]},s))}),i.numQuestions&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:i.numQuestions.message})]}),e.jsxs("section",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-purple-500/20 text-purple-400 flex items-center justify-center mr-3 text-sm font-bold",children:"2"}),"Difficulty Level"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:["Easy","Medium","Hard","Mixed"].map(s=>e.jsxs("label",{className:r("relative flex items-center justify-center p-4 rounded-2xl cursor-pointer transition-all duration-200 border-2",a.difficulty===s?"bg-cyan-500/10 border-cyan-500 shadow-[0_0_20px_-5px_rgba(6,182,212,0.5)]":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"),children:[e.jsx("input",{type:"radio",value:s,...b("difficulty"),className:"hidden"}),e.jsx("span",{className:r("font-bold",a.difficulty===s?"text-cyan-400":"text-slate-300"),children:s})]},s))}),i.difficulty&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:i.difficulty.message})]}),e.jsxs("section",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-pink-500/20 text-pink-400 flex items-center justify-center mr-3 text-sm font-bold",children:"3"}),"Question Types"]}),e.jsx("button",{type:"button",onClick:U,className:"text-sm text-primary hover:text-primary/80 font-medium transition-colors",children:p.length===w.length?"Deselect All":"Select All"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:w.map(s=>{const t=p.includes(s.id);return e.jsxs("label",{className:r("relative flex flex-col items-center justify-center p-4 rounded-2xl cursor-pointer transition-all duration-200 border-2 text-center",t?"bg-pink-500/10 border-pink-500 shadow-[0_0_20px_-5px_rgba(236,72,153,0.5)]":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"),children:[e.jsx("input",{type:"checkbox",value:s.id,...b("types"),className:"hidden"}),e.jsx("div",{className:r("mb-2 p-2 rounded-lg",t?"bg-pink-500/20 text-pink-400":"bg-white/10 text-slate-400"),children:e.jsx(s.icon,{className:"w-6 h-6"})}),e.jsx("span",{className:r("font-bold text-sm",t?"text-pink-400":"text-slate-300"),children:s.label})]},s.id)})}),e.jsx("p",{className:"text-xs text-slate-500 mt-4 text-center",children:"Select specific question types or leave blank to include all."})]}),e.jsxs("section",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-emerald-500/20 text-emerald-400 flex items-center justify-center mr-3 text-sm font-bold",children:"4"}),"Topics"]}),e.jsx("button",{type:"button",onClick:I,className:"text-sm text-primary hover:text-primary/80 font-medium transition-colors",children:m.length===c.length&&c.length>0?"Deselect All":"Select All"})]}),E?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-500"})}):c.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No topics available."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map(s=>{const t=m.includes(s.name);return e.jsxs("label",{className:r("group relative flex items-center p-4 rounded-2xl cursor-pointer transition-all duration-200 border-2 overflow-hidden",t?"bg-emerald-500/10 border-emerald-500 shadow-[0_0_20px_-5px_rgba(16,185,129,0.3)]":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"),children:[e.jsx("div",{className:r("absolute inset-0 opacity-0 transition-opacity duration-300",t?"opacity-100":"group-hover:opacity-10"),children:e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${s.gradient} opacity-5`})}),e.jsx("input",{type:"checkbox",value:s.name,...b("categories"),className:"hidden"}),e.jsx("div",{className:r("p-3 rounded-xl mr-4 transition-colors",t?"bg-emerald-500/20 text-emerald-400":"bg-white/5 text-slate-400 group-hover:text-white"),children:s.icon}),e.jsxs("div",{className:"flex-1 relative z-10",children:[e.jsx("p",{className:r("font-bold transition-colors",t?"text-white":"text-slate-300 group-hover:text-white"),children:s.name}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[s.available," questions"]})]}),t&&e.jsx(re,{className:"w-6 h-6 text-emerald-500 animate-in zoom-in duration-200"})]},s.name)})}),e.jsx("p",{className:"text-xs text-slate-500 mt-4 text-center",children:"Select specific topics or leave blank to include all."}),i.categories&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:i.categories.message})]})]})]})})]})}export{ge as QuizConfig};
