import{d as w,b as a,e as f}from"./index-C1xGmZrK.js";const l=w((n,r)=>({currentAttempt:null,questions:[],responses:new Map,currentQuestionIndex:0,timeRemaining:0,isLoading:!1,generateQuiz:async e=>{n({isLoading:!0});try{const t=await a.post("/quiz/generate.php",e),{attempt:i,questions:s}=t.data;n({currentAttempt:i,questions:s,responses:new Map,currentQuestionIndex:0,timeRemaining:e.timeLimit||0,isLoading:!1})}catch(t){throw n({isLoading:!1}),t}},startAttempt:async e=>{n({isLoading:!0});try{const t=await a.get(`/quiz/get.php?id=${e}`),{attempt:i,questions:s}=t.data;n({currentAttempt:i,questions:s,responses:new Map,currentQuestionIndex:0,timeRemaining:i.time_limit||0,isLoading:!1})}catch(t){throw n({isLoading:!1}),t}},submitAnswer:(e,t,i)=>{const{currentAttempt:s,questions:c,responses:d}=r();if(!s)return;const o=c.find(g=>g.id===e);if(!o)return;const u=t===o.correct_answer,m={id:f(),attempt_id:s.id,question_id:e,user_id:s.user_id,user_answer:t,is_correct:u,time_spent_seconds:i,answered_at:new Date().toISOString(),points_awarded:u?o.points:0,max_points:o.points,question_position:r().currentQuestionIndex+1,skipped:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},p=new Map(d);p.set(e,m),n({responses:p})},nextQuestion:()=>{const{currentQuestionIndex:e,questions:t}=r();e<t.length-1&&n({currentQuestionIndex:e+1})},previousQuestion:()=>{const{currentQuestionIndex:e}=r();e>0&&n({currentQuestionIndex:e-1})},submitQuiz:async()=>{const{currentAttempt:e,responses:t}=r();if(!e)throw new Error("No active quiz attempt");n({isLoading:!0});try{const i=Array.from(t.values());await a.post("/quiz/submit.php",{attemptId:e.id,responses:i}),n({isLoading:!1})}catch(i){throw n({isLoading:!1}),i}},resetQuiz:()=>{n({currentAttempt:null,questions:[],responses:new Map,currentQuestionIndex:0,timeRemaining:0})},setTimeRemaining:e=>n(t=>({timeRemaining:typeof e=="function"?e(t.timeRemaining):e})),setQuiz:(e,t)=>{n({currentAttempt:e,questions:t,responses:new Map,currentQuestionIndex:0,timeRemaining:e.config.timeLimit||0,isLoading:!1})}}));export{l as u};
