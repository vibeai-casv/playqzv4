import{j as e,d as j}from"./index-Cpj8tOwa.js";import{r as m}from"./vendor-D8AvkUoV.js";import{R as f,ac as v,ak as g,al as N,am as w,A as p,k,an as h,x as _,y as T,w as C,i as u}from"./ui-mytIhYa7.js";function E(){const[i,d]=m.useState({}),[n,c]=m.useState({}),l=[{id:"import",name:"Import Diagnostic",description:"Tests JSON import functionality and dependencies",endpoint:"/fix/import-diagnostic.php",icon:v,color:"text-blue-600"},{id:"database",name:"Database Connection",description:"Verifies database connectivity and table structure",endpoint:"/fix/test-database.php",icon:g,color:"text-green-600"},{id:"server",name:"Server Environment",description:"Checks PHP version, extensions, and settings",endpoint:"/fix/test-server-env.php",icon:N,color:"text-purple-600"},{id:"session",name:"Session & Auth",description:"Tests authentication and session management",endpoint:"/fix/test-session.php",icon:w,color:"text-orange-600"},{id:"api",name:"API Endpoints",description:"Tests all API endpoints for accessibility",endpoint:"/fix/test-api-endpoints.php",icon:p,color:"text-cyan-600"}],b=[{id:"view_questions",name:"Raw Question Viewer",description:"Direct database view of all questions with pagination",url:"/fix/view_questions.php",icon:g,color:"text-blue-600"}],o=async s=>{c(t=>({...t,[s.id]:!0}));try{const t=await j.get(`${"https://aiquiz.vibeai.cv/api".replace("/api","")}${s.endpoint}`,{withCredentials:!0});d(a=>({...a,[s.id]:t.data})),u.success(`${s.name} completed`)}catch(t){console.error(`${s.name} error:`,t),u.error(`${s.name} failed`),d(a=>({...a,[s.id]:{error:"Test failed to run"}}))}finally{c(t=>({...t,[s.id]:!1}))}},y=async()=>{for(const s of l)await o(s),await new Promise(t=>setTimeout(t,500))},x=s=>{if(!s)return null;const t=s.ready_for_import===!0||s.overall_status==="HEALTHY"||s.connection==="SUCCESS"||s.logged_in===!0||s.summary&&s.summary.missing===0,a=s.error||s.ready_for_import===!1;return t&&!a?e.jsx(_,{className:"w-5 h-5 text-green-600"}):a?e.jsx(T,{className:"w-5 h-5 text-red-600"}):e.jsx(C,{className:"w-5 h-5 text-yellow-600"})};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"System Diagnostics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Run comprehensive tests to verify system health"})]}),e.jsxs("button",{onClick:y,disabled:Object.values(n).some(Boolean),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[e.jsx(f,{className:`w-4 h-4 ${Object.values(n).some(Boolean)?"animate-spin":""}`}),"Run All Tests"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(s=>{const t=s.icon,a=i[s.id],r=n[s.id];return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(t,{className:`w-6 h-6 ${s.color}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.description})]})]}),a&&x(a)]}),e.jsx("button",{onClick:()=>o(s),disabled:r,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50",children:r?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4 animate-spin"}),"Running..."]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-4 h-4"}),"Run Test"]})}),a&&e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[a.ready_for_import!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Ready:"}),e.jsx("span",{className:a.ready_for_import?"text-green-600":"text-red-600",children:a.ready_for_import?"Yes":"No"})]}),a.overall_status&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:a.overall_status==="HEALTHY"?"text-green-600":"text-yellow-600",children:a.overall_status})]}),a.logged_in!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Logged In:"}),e.jsx("span",{className:a.logged_in?"text-green-600":"text-red-600",children:a.logged_in?"Yes":"No"})]}),a.is_admin!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Is Admin:"}),e.jsx("span",{className:a.is_admin?"text-green-600":"text-red-600",children:a.is_admin?"Yes":"No"})]}),a.error&&e.jsxs("div",{className:"text-red-600 text-xs mt-2",children:["Error: ",a.error]})]})})]},s.id)})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mt-8 mb-4",children:"Database Tools"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(s=>{const t=s.icon;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 space-y-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(t,{className:`w-6 h-6 ${s.color}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.description})]})]})}),e.jsxs("a",{href:`${"https://aiquiz.vibeai.cv/api".replace("/api","")}${s.url}`,target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/40 transition-colors",children:[e.jsx(h,{className:"w-4 h-4"}),"Open Tool"]})]},s.id)})}),Object.keys(i).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Detailed Results"}),e.jsx("div",{className:"space-y-4",children:Object.entries(i).map(([s,t])=>{const a=l.find(r=>r.id===s);return a?e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"cursor-pointer flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a.icon,{className:`w-5 h-5 ${a.color}`}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:a.name})]}),x(t)]}),e.jsx("div",{className:"mt-2 p-4 bg-gray-900 rounded-lg overflow-x-auto",children:e.jsx("pre",{className:"text-xs text-green-400 font-mono",children:JSON.stringify(t,null,2)})})]},s):null})})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(h,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-900 dark:text-blue-100",children:"External Diagnostic Dashboard"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:"You can also access the standalone diagnostic dashboard at:"}),e.jsxs("a",{href:`${"https://aiquiz.vibeai.cv/api".replace("/api","")}/fix/`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 dark:text-blue-400 hover:underline mt-2 inline-block",children:["https://aiquiz.vibeai.cv/api".replace("/api",""),"/fix/"]})]})]})})]})}export{E as Diagnostics};
