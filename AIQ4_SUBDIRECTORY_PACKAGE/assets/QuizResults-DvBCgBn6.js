import{j as e,c}from"./index-T68TGD3V.js";import{u as S,r as p,R as _}from"./vendor-D8AvkUoV.js";import{u as z}from"./quizStore-Cl-0P1Hl.js";import{k as R,$ as A,w as Q,N as L,z as B,B as D,Q as E,R as M,a0 as T,X,i as Y}from"./ui-CEq2p6SN.js";import{R as $,B as K,X as O,Y as I,T as F,b as g,c as P}from"./charts-DqW5DCWa.js";function G({open:o,onClose:l,link:a}){return o?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 animate-in fade-in duration-200",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"bg-slate-900 border border-white/10 rounded-2xl p-6 max-w-sm w-full relative shadow-2xl shadow-black/50 animate-in zoom-in-95 duration-200",children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 text-slate-500 hover:text-white transition-colors",children:e.jsx(X,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-xl font-bold mb-4 text-white",children:"Share Results"}),e.jsx("div",{className:"relative mb-6",children:e.jsx("input",{readOnly:!0,value:a,className:"w-full p-3 pr-12 border border-white/10 rounded-xl bg-black/20 text-slate-300 focus:outline-none focus:border-indigo-500 transition-colors",onClick:i=>i.target.select()})}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(a),Y.success("Copied to clipboard!")},className:"w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-500 transition-all shadow-lg shadow-indigo-600/20",children:"Copy to Clipboard"})]})}):null}function q(){const o=S(),{questions:l,responses:a,currentAttempt:i,isLoading:f,resetQuiz:w}=z(),[n,j]=p.useState("all"),[N,x]=p.useState(!1),d=l.length,m=Array.from(a.values()).filter(t=>t.is_correct).length,h=d?Math.round(m/d*100):0,u=h>=50,b=_.useMemo(()=>{const t={};return l.forEach(s=>{const r=s.category||"Other";t[r]||(t[r]={correct:0,total:0}),t[r].total+=1,a.get(s.id)?.is_correct&&(t[r].correct+=1)}),Object.entries(t).map(([s,r])=>({name:s,...r}))},[l,a]),v=l.filter(t=>{const s=a.get(t.id);return n==="correct"?s?.is_correct:n==="incorrect"?s&&!s.is_correct:!0}),k=async()=>{w(),o("/quiz-config")};if(f||!i)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(R,{className:"w-8 h-8 animate-spin text-indigo-500"})});const y=new Date(i.completed_at||Date.now()).toLocaleString(),C=`${window.location.origin}/quiz-results/${i.id}`;return e.jsxs("div",{className:"max-w-5xl mx-auto p-4 md:p-6 space-y-8",children:[e.jsxs("section",{className:"relative overflow-hidden rounded-3xl bg-slate-900 border border-white/10 p-8 md:p-12 text-center shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 via-purple-500/10 to-pink-500/10"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:c("w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-6 shadow-[0_0_30px_-5px_rgba(0,0,0,0.3)]",u?"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20":"bg-red-500/10 text-red-400 border border-red-500/20"),children:u?e.jsx(A,{className:"w-10 h-10"}):e.jsx(Q,{className:"w-10 h-10"})}),e.jsxs("h1",{className:"text-5xl md:text-6xl font-black text-white mb-4 tracking-tight",children:[h,"%"]}),e.jsxs("p",{className:"text-xl text-slate-300 mb-2",children:["You answered ",e.jsx("span",{className:"text-white font-bold",children:m})," out of ",e.jsx("span",{className:"text-white font-bold",children:d})," questions correctly"]}),e.jsxs("p",{className:"text-sm text-slate-500 uppercase tracking-widest font-medium",children:["Completed on ",y]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("section",{className:"lg:col-span-1 bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 flex flex-col",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[e.jsx(L,{className:"w-5 h-5 mr-3 text-indigo-400"}),"Performance"]}),e.jsx("div",{className:"flex-1 min-h-[300px]",children:e.jsx($,{width:"100%",height:"100%",children:e.jsxs(K,{data:b,layout:"vertical",margin:{top:0,right:30,left:40,bottom:0},children:[e.jsx(O,{type:"number",domain:[0,"dataMax"],hide:!0}),e.jsx(I,{dataKey:"name",type:"category",width:100,tick:{fill:"#94a3b8",fontSize:12},axisLine:!1,tickLine:!1}),e.jsx(F,{contentStyle:{backgroundColor:"#0f172a",borderColor:"#334155",borderRadius:"0.75rem",color:"#f8fafc"},itemStyle:{color:"#e2e8f0"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(g,{dataKey:"total",stackId:"a",fill:"#1e293b",radius:[0,4,4,0],barSize:20}),e.jsx(g,{dataKey:"correct",stackId:"a",fill:"#6366f1",radius:[0,4,4,0],barSize:20,children:b.map((t,s)=>e.jsx(P,{fill:t.correct/t.total>.7?"#10b981":t.correct/t.total>.4?"#f59e0b":"#ef4444"},`cell-${s}`))})]})})})]}),e.jsxs("section",{className:"lg:col-span-2 bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Question Review"}),e.jsx("div",{className:"flex bg-slate-800/50 p-1 rounded-xl",children:["all","correct","incorrect"].map(t=>e.jsx("button",{onClick:()=>j(t),className:c("px-4 py-1.5 rounded-lg text-sm font-medium transition-all capitalize",n===t?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/25":"text-slate-400 hover:text-white hover:bg-white/5"),children:t},t))})]}),e.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar",children:v.map(t=>{const s=a.get(t.id),r=s?.is_correct;return e.jsx("div",{className:"group border border-white/5 rounded-2xl p-5 bg-white/5 hover:bg-white/10 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:c("mt-1 w-6 h-6 rounded-full flex items-center justify-center shrink-0",r?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"),children:r?e.jsx(B,{className:"w-4 h-4"}):e.jsx(D,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-slate-200 mb-3",children:t.question_text}),t.image_url&&e.jsx("div",{className:"mb-4",children:e.jsx("img",{src:t.image_url,alt:"Question",className:"max-h-40 rounded-lg border border-white/10"})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:c("p-3 rounded-xl border",r?"bg-emerald-500/10 border-emerald-500/20 text-emerald-300":"bg-red-500/10 border-red-500/20 text-red-300"),children:[e.jsx("span",{className:"block text-xs opacity-70 mb-1 uppercase tracking-wider font-bold",children:"Your Answer"}),s?.user_answer||"â€”"]}),e.jsxs("div",{className:"p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/20 text-indigo-300",children:[e.jsx("span",{className:"block text-xs opacity-70 mb-1 uppercase tracking-wider font-bold",children:"Correct Answer"}),t.correct_answer]})]}),t.explanation&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl bg-blue-500/10 border border-blue-500/20 text-blue-200",children:[e.jsx("span",{className:"block text-xs opacity-70 mb-2 uppercase tracking-wider font-bold",children:"Explanation"}),e.jsx("p",{className:"text-sm leading-relaxed",children:t.explanation})]})]})]})},t.id)})})]})]}),e.jsxs("section",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 pt-4 border-t border-white/5",children:[e.jsxs("button",{onClick:()=>o("/dashboard"),className:"w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-3 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 transition-colors font-medium",children:[e.jsx(E,{className:"w-4 h-4"})," Back to Dashboard"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto",children:[e.jsxs("button",{onClick:k,className:"flex items-center justify-center gap-2 px-6 py-3 bg-indigo-600 text-white hover:bg-indigo-500 rounded-xl font-bold transition-all shadow-lg shadow-indigo-600/20",children:[e.jsx(M,{className:"w-4 h-4"})," Retake Quiz"]}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-600 text-white hover:bg-emerald-500 rounded-xl font-bold transition-all shadow-lg shadow-emerald-600/20",children:[e.jsx(T,{className:"w-4 h-4"})," Share Results"]})]})]}),e.jsx(G,{open:N,onClose:()=>x(!1),link:C})]})}export{q as QuizResults};
