import{u as N,a as v,j as e,S as m,c as g}from"./index-C57Ivx-l.js";import{r as i,L as h}from"./vendor-D8AvkUoV.js";import{T as k,R as S,o as A,p as C,q as j,r as D,A as R,f as _,s as w,H as E,k as T,u as L,v as M}from"./ui-8QwkGQs4.js";import{R as z,A as G,C as Q,X as U,Y,T as P,a as H}from"./charts-BmfKxUFP.js";function O(){const{user:l}=N(),[t,r]=i.useState(null),[c,n]=i.useState([]),[d,a]=i.useState(!1),[o,s]=i.useState(null),p=i.useCallback(async()=>{if(l){a(!0),s(null);try{const x=await v.get("/user/stats.php"),{stats:f,recentAttempts:u}=x.data;r(f),n(u||[])}catch(x){console.error("Error fetching user stats:",x),s(x.message)}finally{a(!1)}}},[l]);return{stats:t,recentAttempts:c,loading:d,error:o,fetchStats:p}}function $({value:l,duration:t=2e3,prefix:r="",suffix:c=""}){const[n,d]=i.useState(0);return i.useEffect(()=>{let a=null;const o=0,s=p=>{a||(a=p);const x=p-a,f=Math.min(x/t,1),u=1-Math.pow(1-f,4),y=Math.floor(o+(l-o)*u);d(y),x<t&&requestAnimationFrame(s)};requestAnimationFrame(s)},[l,t]),e.jsxs("span",{children:[r,n.toLocaleString(),c]})}class F extends i.Component{state={hasError:!1,error:null};static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"min-h-[400px] flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(k,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-md",children:"We encountered an error while loading this section. Please try refreshing the page."}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Refresh Page"]}),!1]}):this.props.children}}const b=({title:l,value:t,prefix:r,suffix:c,icon:n,gradient:d,delay:a,isLoading:o})=>e.jsxs("div",{className:"relative group overflow-hidden rounded-2xl bg-slate-900/50 border border-white/5 p-6 hover:border-white/10 transition-all duration-300 animate-in fade-in slide-in-from-bottom-4",style:{animationDelay:`${a}ms`},children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${d} opacity-5 group-hover:opacity-10 transition-opacity`}),e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-400",children:l}),e.jsx("h3",{className:"text-3xl font-bold text-white mt-2 tracking-tight",children:o?e.jsx(m,{className:"h-8 w-24 bg-slate-800"}):e.jsx($,{value:t,prefix:r,suffix:c})})]}),e.jsx("div",{className:"p-3 rounded-xl bg-white/5 border border-white/5 group-hover:scale-110 transition-transform duration-300",children:e.jsx(n,{className:"w-6 h-6 text-white"})})]})]});function I(){const{user:l}=N(),{stats:t,recentAttempts:r,loading:c,fetchStats:n}=O(),[d,a]=i.useState("");i.useEffect(()=>{const s=new Date().getHours();s<12?a("Good morning"):s<18?a("Good afternoon"):a("Good evening"),n()},[n]);const o=i.useMemo(()=>[...r].reverse().filter(s=>s.status==="completed").map(s=>({date:new Date(s.created_at).toLocaleDateString(void 0,{month:"short",day:"numeric"}),score:s.score||0})),[r]);return c&&!t?e.jsxs("div",{className:"space-y-8 p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{className:"h-10 w-64 mb-2 bg-slate-800"}),e.jsx(m,{className:"h-5 w-96 bg-slate-800"})]}),e.jsx(m,{className:"h-12 w-40 rounded-lg bg-slate-800"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsx(m,{className:"h-32 rounded-2xl bg-slate-800"},s))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx(m,{className:"lg:col-span-2 h-96 rounded-2xl bg-slate-800"}),e.jsx(m,{className:"h-96 rounded-2xl bg-slate-800"})]})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-primary via-cyan-500 to-blue-500 p-8 md:p-12 shadow-2xl shadow-primary/20",children:[e.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-64 h-64 bg-white/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-40 h-40 bg-black/10 rounded-full blur-2xl"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-white tracking-tight flex flex-wrap items-center gap-3",children:[d,", ",l?.name||"User","! ðŸš€",l?.role==="admin"&&e.jsx("span",{className:"text-sm font-bold bg-white/20 text-white px-3 py-1 rounded-full border border-white/30 backdrop-blur-sm",children:"[ ADMIN ]"})]}),e.jsx("p",{className:"text-white/90 mt-2 text-lg whitespace-nowrap overflow-hidden text-ellipsis max-w-full",children:"Ready to expand your knowledge? Your AI learning assistant is prepped and waiting."})]}),e.jsxs(h,{to:"/quiz-config",className:"btn-vibeai-outline bg-white/10 backdrop-blur-sm border-white hover:bg-white hover:text-primary inline-flex items-center justify-center group",children:[e.jsx(A,{className:"w-5 h-5 mr-2 group-hover:rotate-12 transition-transform"}),"Start New Quiz"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(b,{title:"Total Quizzes",value:t?.total_attempts||0,icon:C,gradient:"from-primary to-cyan-400",delay:0}),e.jsx(b,{title:"Average Score",value:Math.round(t?.average_score||0),suffix:"%",icon:j,gradient:"from-emerald-500 to-teal-500",delay:100}),e.jsx(b,{title:"Completion Rate",value:Math.round(t?.completion_rate||0),suffix:"%",icon:D,gradient:"from-cyan-500 to-blue-500",delay:200})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Performance Trend"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Your score progression over time"})]}),e.jsx("div",{className:"p-2 bg-white/5 rounded-lg",children:e.jsx(j,{className:"w-5 h-5 text-primary"})})]}),e.jsx("div",{className:"h-80 w-full",children:o.length>0?e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(G,{data:o,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorScore",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]})}),e.jsx(Q,{strokeDasharray:"3 3",vertical:!1,stroke:"rgba(255,255,255,0.05)"}),e.jsx(U,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fill:"#94a3b8",fontSize:12},dy:10}),e.jsx(Y,{axisLine:!1,tickLine:!1,tick:{fill:"#94a3b8",fontSize:12}}),e.jsx(P,{contentStyle:{backgroundColor:"#1e293b",borderColor:"rgba(255,255,255,0.1)",borderRadius:"12px",color:"#fff",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.5)"},itemStyle:{color:"#fff"}}),e.jsx(H,{type:"monotone",dataKey:"score",stroke:"#6366f1",strokeWidth:3,fillOpacity:1,fill:"url(#colorScore)"})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500",children:[e.jsx(R,{className:"w-12 h-12 mb-4 opacity-20"}),e.jsx("p",{children:"No performance data available yet"})]})})]}),e.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 p-6 md:p-8 flex flex-col",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-4 flex-1",children:[e.jsx(h,{to:"/profile",className:"block p-4 rounded-2xl bg-white/5 hover:bg-white/10 border border-white/5 hover:border-primary/30 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/20 flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:e.jsx(_,{className:"w-6 h-6"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"font-bold text-white group-hover:text-primary transition-colors",children:"Update Profile"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Manage your account"})]})]}),e.jsx(w,{className:"w-5 h-5 text-slate-500 group-hover:text-white group-hover:translate-x-1 transition-all"})]})}),e.jsx(h,{to:"/history",className:"block p-4 rounded-2xl bg-white/5 hover:bg-white/10 border border-white/5 hover:border-emerald-500/30 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-emerald-500/20 flex items-center justify-center text-emerald-400 group-hover:scale-110 transition-transform",children:e.jsx(E,{className:"w-6 h-6"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"font-bold text-white group-hover:text-emerald-400 transition-colors",children:"Review History"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Analyze past results"})]})]}),e.jsx(w,{className:"w-5 h-5 text-slate-500 group-hover:text-white group-hover:translate-x-1 transition-all"})]})})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm rounded-3xl border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-6 md:p-8 border-b border-white/5 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Recent Quizzes"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Your latest assessment sessions"})]}),e.jsxs(h,{to:"/history",className:"text-sm font-medium text-primary hover:text-primary/80 flex items-center transition-colors",children:["View All ",e.jsx(T,{className:"w-4 h-4 ml-1"})]})]}),r.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm text-slate-400",children:[e.jsx("thead",{className:"bg-white/5 text-xs uppercase text-slate-300 font-semibold tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Topic"}),e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4",children:"Score"}),e.jsx("th",{className:"px-6 py-4",children:"Time"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:r.map(s=>e.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-white",children:s.config?.categories?.join(", ")||"General Quiz"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"w-4 h-4 mr-2 text-slate-500"}),new Date(s.created_at).toLocaleDateString()]})}),e.jsx("td",{className:"px-6 py-4",children:s.status==="completed"?e.jsxs("span",{className:g("px-3 py-1 rounded-full text-xs font-bold",(s.score||0)>=80?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/20":(s.score||0)>=60?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/20":"bg-red-500/20 text-red-400 border border-red-500/20"),children:[s.score,"%"]}):e.jsx("span",{className:"text-slate-600",children:"-"})}),e.jsx("td",{className:"px-6 py-4 font-mono text-slate-300",children:s.time_spent_seconds?`${Math.floor(s.time_spent_seconds/60)}m ${s.time_spent_seconds%60}s`:"-"}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("span",{className:g("px-3 py-1 rounded-full text-xs font-bold capitalize",s.status==="completed"?"bg-blue-500/20 text-blue-400 border border-blue-500/20":"bg-slate-700 text-slate-300"),children:s.status.replace("_"," ")})})]},s.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mb-4 border border-white/10",children:e.jsx(M,{className:"w-8 h-8 text-slate-500"})}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"No quizzes taken yet"}),e.jsx("p",{className:"text-slate-400 mt-2 max-w-sm",children:"You haven't taken any quizzes yet. Start your first quiz to see your history here!"}),e.jsx(h,{to:"/quiz-config",className:"btn-vibeai mt-6 inline-flex items-center",children:"Take a Quiz"})]})]})]})}function B(){return e.jsx(F,{children:e.jsx(I,{})})}export{B as Dashboard};
