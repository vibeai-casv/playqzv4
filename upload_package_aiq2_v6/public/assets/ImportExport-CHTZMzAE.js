import{j as e,c as y,a as D}from"./index-C57Ivx-l.js";import{r as n}from"./vendor-D8AvkUoV.js";import{u as R}from"./useAdmin-03L9WaYx.js";import{h as s,D as q,a7 as b,ag as T,am as C,an as F,j as _,ab as P,X as U}from"./ui-8QwkGQs4.js";function X(){const{fetchQuestions:E,isLoading:I}=R(),[c,f]=n.useState("export"),[x,Q]=n.useState([]),[i,m]=n.useState(new Set),[l,j]=n.useState({type:"all",difficulty:"all"}),[N,p]=n.useState(null),[g,h]=n.useState([]),[k,v]=n.useState(!1);n.useEffect(()=>{c==="export"&&w()},[c,l]);const w=async()=>{try{const t={};l.type!=="all"&&(t.type=l.type),l.difficulty!=="all"&&(t.difficulty=l.difficulty);const{questions:r}=await E(t);Q(r)}catch(t){console.error(t),s.error("Failed to load questions")}},O=t=>{const r=new Set(i);r.has(t)?r.delete(t):r.add(t),m(r)},A=()=>{i.size===x.length?m(new Set):m(new Set(x.map(t=>t.id)))},J=()=>{if(i.size===0){s.error("Please select at least one question to export");return}const t=x.filter(o=>i.has(o.id)).map(({created_at:o,updated_at:S,...u})=>u),r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),d=URL.createObjectURL(r),a=document.createElement("a");a.href=d,a.download=`questions_export_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(d),s.success(`Exported ${i.size} questions`)},L=async t=>{const r=t.target.files?.[0];if(r){if(!r.name.endsWith(".json")){s.error("Please select a JSON file");return}p(r);try{const d=await r.text(),a=JSON.parse(d);if(!Array.isArray(a)){s.error("Invalid JSON format. Expected an array of questions");return}h(a),s.success(`Loaded ${a.length} questions from file`)}catch(d){console.error(d),s.error("Failed to parse JSON file")}}},z=async()=>{if(g.length===0){s.error("No questions to import");return}v(!0);try{const r=(await D.post("/questions/import.php",{questions:g})).data,{imported:d,skipped:a,errors:o,summary:S}=r;if(d>0?s.success(`Import complete! ${S}`,{duration:5e3}):s.error("No questions were imported"),o&&o.length>0){console.log("Import errors:",o);const u=o.slice(0,5).join(`
`),$=o.length>5?`
...and ${o.length-5} more`:"";s.warning(`${a} question(s) skipped:
${u}${$}`,{duration:8e3})}p(null),h([]),c==="export"&&w()}catch(t){console.error(t),s.error(t instanceof Error?t.message:"Failed to import questions")}finally{v(!1)}};return e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Import / Export Questions"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Export questions to JSON or import questions from a JSON file"})]}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-1 rounded-xl inline-flex",children:[e.jsxs("button",{onClick:()=>f("export"),className:y("px-6 py-2.5 rounded-lg font-medium transition-all flex items-center gap-2",c==="export"?"bg-white dark:bg-gray-700 shadow-lg text-indigo-600 dark:text-indigo-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:[e.jsx(q,{className:"w-4 h-4"}),"Export Questions"]}),e.jsxs("button",{onClick:()=>f("import"),className:y("px-6 py-2.5 rounded-lg font-medium transition-all flex items-center gap-2",c==="import"?"bg-white dark:bg-gray-700 shadow-lg text-indigo-600 dark:text-indigo-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:[e.jsx(b,{className:"w-4 h-4"}),"Import Questions"]})]}),c==="export"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(T,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Question Type"}),e.jsxs("select",{value:l.type,onChange:t=>j({...l,type:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"text_mcq",children:"Multiple Choice"}),e.jsx("option",{value:"image_identify_logo",children:"Logo Identification"}),e.jsx("option",{value:"image_identify_person",children:"Person Identification"}),e.jsx("option",{value:"true_false",children:"True/False"}),e.jsx("option",{value:"short_answer",children:"Short Answer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Difficulty Level"}),e.jsxs("select",{value:l.difficulty,onChange:t=>j({...l,difficulty:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Difficulties"}),e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Select Questions (",i.size," of ",x.length,")"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Choose questions to export"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:A,className:"px-4 py-2 text-sm font-medium text-indigo-600 hover:text-indigo-700 dark:text-indigo-400 flex items-center gap-2",children:i.size===x.length?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4"}),"Deselect All"]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4"}),"Select All"]})}),e.jsxs("button",{onClick:J,disabled:i.size===0,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium",children:[e.jsx(q,{className:"w-4 h-4"}),"Export Selected"]})]})]}),e.jsx("div",{className:"p-6",children:I?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(_,{className:"w-8 h-8 animate-spin text-indigo-600"})}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No questions found with current filters"})]}):e.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:x.map(t=>e.jsx("div",{onClick:()=>O(t.id),className:y("p-4 rounded-lg border cursor-pointer transition-all",i.has(t.id)?"bg-indigo-50 dark:bg-indigo-900/20 border-indigo-500":"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-1",children:i.has(t.id)?e.jsx(C,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}):e.jsx(F,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.question_text}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:t.question_type.replace(/_/g," ")}),e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 capitalize",children:t.difficulty}),e.jsxs("span",{className:"text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300",children:[t.points," pts"]})]})]})]})},t.id))})})]})]}),c==="import"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Select JSON File"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center",children:[e.jsx(b,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("input",{type:"file",accept:".json",onChange:L,className:"hidden",id:"import-file"}),e.jsx("label",{htmlFor:"import-file",className:"inline-block px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 cursor-pointer font-medium",children:"Choose JSON File"}),N&&e.jsxs("p",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:["Selected: ",e.jsx("span",{className:"font-medium",children:N.name})]})]})]}),g.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Preview (",g.length," questions)"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Review questions before importing"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{h([]),p(null)},className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Cancel"]}),e.jsx("button",{onClick:z,disabled:k,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 font-medium",children:k?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4"}),"Import All"]})})]})]}),e.jsx("div",{className:"p-6 space-y-3 max-h-[500px] overflow-y-auto",children:g.map((t,r)=>e.jsxs("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50 border border-gray-200 dark:border-gray-600",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.question_text}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:t.question_type?.replace(/_/g," ")}),e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 capitalize",children:t.difficulty})]})]},r))})]})]})]})}export{X as ImportExport};
